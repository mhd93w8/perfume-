<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart - MKM Perfume</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
<style>/* Custom CSS */
   body {
        font-family: 'Comic Sans MS', cursive, sans-serif;
    background-color: #89728a31;

    }
    
    nav{position: relative;
    height: 83px;}


    .navbar-brand {
      font-size: 1.8rem;
      
    }

    .navbar-nav .nav-link {
                font-size: 1.2rem; /* حجم الخط  */ 
                margin-right: 20px;
                transition: color 0.8 s;
             }

         .navbar-nav .nav-link:hover {
                color: #68473d; 
                transform: scale(1.2);
                transition: calc(0.3s) ;
                
             }

        
             .navbar {
                background-color: #e7e4e4; 
                box-shadow: 0px 2px 5px rgba(204, 203, 200, 0.938);
                padding: 15px 0;
             }

         .navbar-brand img {
                height:25px;
                width: auto;
                margin-top: -10px;
                margin-left: -70px;
                margin-right: 40px;
             }

         .navbar .cart-icon,
         .navbar .login-icon,
         .navbar .signup-icon {
               font-size: 1.4rem; 
               margin-left: 15px; 
               color: #4E342E; 
               padding: 8px;
               transition: color 0.3s;
             }
.navbar-scrolled {
     transition: background-color 0.3s ease-in-out;
     
}
nav.navbar-scrolled {
    background-color:#f0e8e8 !important; /* Add !important to override Bootstrap styles */
}
/* Cart Section */
.cart-section {
    padding: 150px ;
 
}




.cart-item {
   
    border: 1px solid #ddd;
    padding: 20px;
    margin-bottom: 20px;
    background-color: #d3d3d300;
    border-radius: 10px;
   width: 750px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.cart-item img {
    max-width: 80%;

    border-radius: 10px;
}

.cart-item h3 {
    font-size: 1.3rem;
    margin-top: -25px;
}

.cart-item p {
    margin-bottom: 5px;
}

.cart-item .btn {
  position: absolute;
    font-size: 1rem;
    padding: 8px 16px;
    border-radius: 50px;
  margin-top: -40px;
    margin-left: 590px;
border: none;
}

.cart-item .btn-danger {
    background-color: #68494c;
    border-color: #ffffff;
}

.cart-item .btn-danger:hover {
    background-color: #44292c;
    border-color: #4d272b;
    transform: scale(1.1);
    transition: 0.4s;
}

/* Cart Summary */
.cart-summary {
    position: fixed; /* Change position to sticky */
    top: 30px; /* Adjust top position as needed */
    padding: 20px; /* Reduce padding for compactness */
    border-radius: 10px;
    margin-left: 800px;
    margin-top: 13%;
    background-color: #fff; /* Set background color to white for better visibility */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    z-index: 999; /* Ensure cart summary is on top of other elements */
}



.cart-summary h2 {
    margin-bottom: 20px;
}

.cart-summary hr {
    border-top: 1px solid #ddd;
    margin-bottom: 20px;
}

.cart-summary p {
    margin-bottom: 10px;
    font-size: 1.1rem;
}

.cart-summary .btn-primary {
    font-size: 1rem;
    padding: 10px 20px;
    border-radius: 5px;
}
      input[type="number"]{
         border: none;
     width: 12%;
        }
.col-lg-4 .btn-danger{
    background-color: #68494c;
    border-color: #ffffff;
}
.col-lg-4 .btn-danger:hover {
    background-color: #573438;
    border-color: #4d272b;
}

</style>
</head>
<body>
    <!-- Navbar -->
   <!-- Navbar -->
<nav id="navbar" class="navbar navbar-expand-lg navbar-light fixed-top">
  <!-- Your navbar content here -->
  <div class="container">
    <a class="navbar-brand" href="">
      <img src="/static/image/Perfumey-Logo-Transparent.png" alt="Logo"> 
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link" aria-current="page" href="{% url 'main'%}">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'shop'%}">Shop</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'about'%}">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'contact'%}">Contact</a>
        </li>
      </ul>
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link cart-icon" href="{% url 'basket'%}"><i class="fas fa-shopping-cart"></i></a>
        </li>
        <li class="nav-item">
          <a class="nav-link login-icon" href="{% url 'login'%}"><i class="fas fa-user"></i></a>
        </li>
        <li class="nav-item">
          <a class="nav-link signup-icon" href="{% url 'sign_up'%}"><i class="fas fa-user-plus"></i></a>
        </li>
      </ul>
     
    
     
      <form class="d-flex navbar-search" action="{% url 'result' %}" method="GET">
        <input name="search" class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
        <button class="btn btn-outline-dark" type="submit"><i class="fas fa-search"></i></button>
    </form>
   
    
    
    </div>
    
  </div>
 
</nav>
    <!-- Cart Section -->
    <section class="cart-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <h2 class="mb-4">Your Shopping Cart</h2>
                    <!-- Cart items list -->
                                       <!-- Cart Items list -->
                  <div class="cart-items">
                     <!-- Iterate over basket items -->
                    {% for item in basket_items %}
                      <div class="cart-item">
                        <div class="row align-items-center">
                           <div class="col-md-3">
                              <img src="{{ item.ImageURL }}" alt="Product Image" class="img-fluid rounded">
                           </div>
                           <div class="col-md-6">
                            <h3 class="mb-2">{{ item.Name_product }}</h3>
                            <p class="text-muted">Price: ${{ item.Price_product }}</p>
                            <div class="quantity-selector">
                                <span class="quantity-label">Quantity:</span>
                                <form class="update-quantity-form" method="post" action="{% url 'update_quantity' %}">
                                    {% csrf_token %}
                                    <input type="hidden" name="item_id" value="{{ item.pk }}">
                                    <input type="number" name="quantity" class="quantity-input" value="{{ item.Quantity_product }}" min="1">
                                    <button type="submit">Save</button>
                                </form>
                            </div>
                        </div>
                        
                          
                         </div>
                         <div class="col-md-3">
                            <form action="{% url 'remove_from_basket' item.id %}" method="post">
                              {% csrf_token %}
                              <button type="submit" class="btn btn-danger"><i class="fas fa-trash-alt me-1"></i> Remove</button>
                           </form>
                       </div>
                     </div>
                   </div>
                   {% endfor %}
                     <!-- End Iterate -->
                  </div>

            
                
            </div>
        </div>
        <div class="col-lg-4">
            <div class="cart-summary bg-light p-4 rounded">
                <h2 class="mb-4">Cart Summary</h2>
                <hr class="my-3">
                <p class="text-muted">Total Items: {{ total_quantity }}</p>
                <p class="text-muted">Total Price: {{ total_price }} $</p>
                <form action="/checkout">
                    <button class="btn btn-danger"><i class="fas fa-trash-alt me-1"></i> Proceed To Checkout</button>
                </form>
            </div>
        </div>
    </section>
<br><br><br><br><br><br><br><br><br><br><br><br>
     <!-- Footer -->
 <footer class="text-center text-lg-start mt-5 bg-dark text-white">
    <div class="container p-4">
        <div class="row">
            <div class="col-lg-6 col-md-12 mb-4 mb-md-0">
                <h5 class="text-uppercase">Footer Content</h5>
                <p>
                    You can use rows and columns to organize your footer content.
                </p>
            </div>
            <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                <h5 class="text-uppercase">Links</h5>
                <ul class="list-unstyled mb-0">
                    <li class="mb-2">
                        <a href="#!" class="text-white text-decoration-none">Link 1</a>
                    </li>
                    <li class="mb-2">
                        <a href="#!" class="text-white text-decoration-none">Link 2</a>
                    </li>
                </ul>
            </div>
            <!-- Add Social Icons Section -->
            <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                <h5 class="text-uppercase">Social Media</h5>
                <ul class="list-unstyled mb-0">
                    <li class="mb-2">
                        <a href="#" class="text-white text-decoration-none"><i class="fab fa-facebook-f"></i> Facebook</a>
                    </li>
                    <li class="mb-2">
                        <a href="#" class="text-white text-decoration-none"><i class="fab fa-twitter"></i> Twitter</a>
                    </li>
                    <li class="mb-2">
                        <a href="#" class="text-white text-decoration-none"><i class="fab fa-instagram"></i> Instagram</a>
                    </li>
                </ul>
            </div>
            <!-- End Social Icons Section -->
        </div>
    </div>
    <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.05);">
        © 2024 My Perfume Store
    </div>
</footer>
    <!-- Footer -->

    
    <!-- Bootstrap JavaScript -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        window.onscroll = function() {scrollFunction()};
   
       function scrollFunction() {
           var navbar = document.getElementById("navbar");
           if (document.body.scrollTop > 80 || document.documentElement.scrollTop > 80) {
               navbar.classList.add("navbar-scrolled");
           } else {
               navbar.classList.remove("navbar-scrolled");
           }
       }
     $(document).ready(function() {
       $('.star').click(function() {
         var value = $(this).attr('data-value');
         $(this).addClass('selected');
         $(this).prevAll('.star').addClass('selected');
         $(this).nextAll('.star').removeClass('selected');
         // You can add code here to send the rating to the server or perform other actions
       });
     });
     
     
   </script>
   <script>
    document.addEventListener("DOMContentLoaded", function() {
        const updateQuantityForm = document.getElementById('update-quantity-form');
        const itemIdInput = document.getElementById('item_id');
        const quantityInput = document.getElementById('quantity');
    
        // Function to set the item ID and quantity in the form
        function setFormValues(itemId, quantity) {
            itemIdInput.value = itemId;
            quantityInput.value = quantity;
        }
    
        // Event listener for the form submission
        updateQuantityForm.addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent default form submission
            const formData = new FormData(updateQuantityForm); // Get form data
            fetch(updateQuantityForm.action, {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}' // Add CSRF token to headers
                }
            })
            .then(response => {
                if (response.ok) {
                    // Success: reload the page or perform any other action
                    window.location.reload();
                } else {
                    // Handle error
                    console.error('Failed to update quantity');
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });
    
        // Example: Set initial values (replace with actual values if needed)
        const initialItemId = '{{ basket_items.0.pk }}';
        const initialQuantity = '{{ basket_items.0.Quantity_product }}';
        setFormValues(initialItemId, initialQuantity);
    });
    </script>
    
   
</body>
</html>
